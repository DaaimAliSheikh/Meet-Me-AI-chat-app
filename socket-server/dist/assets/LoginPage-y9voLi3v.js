import{r as o,c as w,u as L,a as S,j as s,B as d,b as U,L as C}from"./index-4MMvhHEo.js";import{C as P,a as v,L as I}from"./card-L_1ZyKZj.js";import{z as n,u as M,F as A,a as u,b as x,c as g,d as h,I as f,e as j,t as k}from"./zod-DcnfW7Yi.js";import{A as z,E as B,S as G,a as p,F as J}from"./SuccessAlert-CpxNBwIW.js";const O=n.object({email:n.string().email({message:"Invalid email address format"}),password:n.string().min(8,{message:"Password must be at least 8 characters long"}).max(32,{message:"Password must be at most 32 characters long"})}),R=()=>{const[l,e]=o.useState(null),[c,i]=o.useState(null),b=w(a=>a.setUser),[N,D]=L(),y=o.useCallback(async a=>{var m;const{email:F,password:E}=a;try{const t=await S.post("/auth/login",{email:F,password:E});b(t.data.user),localStorage.setItem("chat-user",JSON.stringify(t.data.user))}catch(t){t instanceof z&&(i(null),e(((m=t.response)==null?void 0:m.data.message)||"Unable to login"))}},[]);o.useEffect(()=>{N.get("credentials")==="true"&&(i(null),e("Email already registered with Email and Password credentials"))},[]);const r=M({shouldUnregister:!1,resolver:k(O),defaultValues:{email:"",password:""}});return s.jsx(P,{children:s.jsxs(v,{className:"mt-4 r",children:[s.jsx(A,{...r,children:s.jsxs("form",{onSubmit:r.handleSubmit(y),className:"space-y-4 flex flex-col",children:[s.jsx(u,{control:r.control,name:"email",render:({field:a})=>s.jsxs(x,{children:[s.jsx(g,{children:"Email"}),s.jsx(h,{children:s.jsx(f,{placeholder:"xyz@example.com",...a})}),s.jsx(j,{})]})}),s.jsx(u,{control:r.control,name:"password",render:({field:a})=>s.jsxs(x,{children:[s.jsx(g,{children:"Password"}),s.jsx(h,{children:s.jsx(f,{type:"password",placeholder:"password",...a})}),s.jsx(j,{})]})}),l?s.jsx(B,{children:l}):null,c?s.jsx(G,{children:c}):null,s.jsxs(d,{disabled:r.formState.isSubmitting,className:" w-full text-foreground",type:"submit",children:["Login",r.formState.isSubmitting?s.jsx(I,{className:"animate-spin ml-2"}):null]}),s.jsxs("div",{className:"flex items-center w-full",children:[s.jsx(p,{className:"w-[45%] mr-2"}),s.jsx("p",{className:"text-muted-foreground",children:"or"}),s.jsx(p,{className:"w-[45%] ml-2"})]})]})}),s.jsxs(d,{onClick:()=>window.location.href=U+"/api/auth/google",className:"w-full mt-2",variant:"secondary",children:[s.jsx(J,{className:" text-2xl mr-2 "}),s.jsx("p",{children:"Sign in with Google"})]})]})})},K=()=>{const l=w(e=>e.setUser);return o.useEffect(()=>{(async()=>{try{const e=await S.get("auth/login/success");if(!e.data.user)return;l(e.data.user),localStorage.setItem("chat-user",JSON.stringify(e.data.user))}catch{console.log("could not get user")}})()},[]),s.jsxs("div",{className:"p-1 flex w-full flex-col max-w-[35rem] mx-auto mt-6",children:[s.jsx("h2",{className:"text-xl p-1 py-2",children:"Login"}),s.jsx(R,{}),s.jsx(C,{to:"/register",className:"text-sm text-muted-foreground text-center  underline my-4",children:"Don't have an account? Sign Up"})]})};export{K as default};
